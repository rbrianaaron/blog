<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>The Multinomial Distribution in R</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="rbrianaaron">

    <!-- Le styles -->
    <link rel="stylesheet" href="http://rbrianaaron.github.io/blog/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="http://rbrianaaron.github.io/blog/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="http://rbrianaaron.github.io/blog/theme/css/font-awesome.css" rel="stylesheet">

    <link href="http://rbrianaaron.github.io/blog/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://rbrianaaron.github.io/blog/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="http://rbrianaaron.github.io/blog/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://rbrianaaron.github.io/blog/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://rbrianaaron.github.io/blog/theme/images/apple-touch-icon-114x114.png">

    <link href="http://rbrianaaron.github.io/blog/" type="application/atom+xml" rel="alternate" title="rbrianaaron ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://rbrianaaron.github.io/blog/index.html">rbrianaaron </a>
          <div class="nav-collapse">
            <ul class="nav">
                <li><a href="http://rbrianaaron.github.io/blog/pages/about.html">About</a></li>
                          <li class="divider-vertical"></li>
                  <li >
                    <a href="http://rbrianaaron.github.io/blog/category/reflections.html">
						<i class="icon-folder-open icon-large"></i>Reflections
					</a>
                  </li>
                  <li class="active">
                    <a href="http://rbrianaaron.github.io/blog/category/tutorials.html">
						<i class="icon-folder-open icon-large"></i>Tutorials
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="http://rbrianaaron.github.io/blog/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to The Multinomial Distribution in R">
                                        The Multinomial Distribution in R
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2014-12-23T16:04:05.953397-05:00">
        <i class="icon-calendar"></i>Tue 23 December 2014
</abbr>
<span class="label">By</span>
<a href="http://rbrianaaron.github.io/blog/author/rbrianaaron.html"><i class="icon-user"></i>rbrianaaron</a>
<span class="label">Category</span>
<a href="http://rbrianaaron.github.io/blog/category/tutorials.html"><i class="icon-folder-open"></i>Tutorials</a>.


<span class="label">Tags</span>
	<a href="http://rbrianaaron.github.io/blog/tag/r.html"><i class="icon-tag"></i>R</a>
	<a href="http://rbrianaaron.github.io/blog/tag/statistics.html"><i class="icon-tag"></i>statistics</a>
</footer><!-- /.post-info -->                </div>
                <p>I just watched the excellent tutorial video by jbstatistics, <a href="https://www.youtube.com/watch?v=syVW7DgvUaY">Introduction to the Multinomial Distribution</a>.</p>
<p>The examples in this post are taken from the video.*</p>
<p>Example 1:
The distibution of blood types in the US is:</p>
<table>
<thead>
<tr>
<th align="center">Type</th>
<th align="center">O</th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">AB</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">probablity</td>
<td align="center">0.44</td>
<td align="center">0.42</td>
<td align="center">0.10</td>
<td align="center">0.04</td>
</tr>
</tbody>
</table>
<p>In a random sample of 10 Americans, what is the probability that 6 have bloodtype O, 2 have A, 1 has B, and 1 has AB?</p>
<p>The equation for the multinomial distribution is:</p>
<blockquote>
<p>P(X1=x1, ... Xk=xk) = n! / x1!...xk! * p1^x1,...pk^xk</p>
<p>P(x1=6, x2=2, x3=1, x4=1) = 10! / 6!<em>2!</em>1!<em>1! * 0.44^6 </em>0.42^2<em>0.10^1</em>0.04^1</p>
</blockquote>
<p>The following is the function documentation for <a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/Multinom.html">dmultinom</a> in R:</p>
<div class="highlight"><pre># dmultinom(x, size = NULL, prob, log = FALSE)
#
# x vector of length K of integers in 0:size.
#
# n number of random vectors to draw.
#
# size  integer, say N, specifying the total number of objects that are put into K boxes in the typical multinomial experiment. 
#  For dmultinom, it defaults to sum(x).
#
# prob  numeric non-negative vector of length K, specifying the probability for the K classes; is internally normalized to sum 1. 
#  Infinite and missing values are not allowed.
# log   logical; if TRUE, log probabilities are computed.
</pre></div>


<p>The following is the solution in R:</p>
<div class="highlight"><pre><span class="o">&gt;</span> x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">6</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="o">&gt;</span> p <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">0.44</span><span class="p">,</span> <span class="m">0.42</span><span class="p">,</span> <span class="m">0.10</span><span class="p">,</span> <span class="m">0.04</span><span class="p">)</span>
<span class="o">&gt;</span> dmultinom<span class="p">(</span>x<span class="p">,</span> size<span class="o">=</span><span class="m">10</span><span class="p">,</span> prop<span class="o">=</span>p<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.01290254</span>
</pre></div>


<p>Example 2:</p>
<p>An urn contains 8 red balls, 3 yellow balls, and 9 white balls. 6 balls are randomly selected without replacement. What is the probability that 2 are red,
1 is yellow, and 3 are white?</p>
<blockquote>
<p>P(x1=2, x2=1, x3=3) = 6! / 2!<em>1!</em>3! * (8/20)^2 * (3/20)^1 * (9/20)^3</p>
</blockquote>
<p>The solution in R:</p>
<div class="highlight"><pre><span class="o">&gt;</span> x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
<span class="o">&gt;</span> p <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">8</span><span class="o">/</span><span class="m">20</span><span class="p">,</span> <span class="m">3</span><span class="o">/</span><span class="m">20</span><span class="p">,</span> <span class="m">9</span><span class="o">/</span><span class="m">20</span><span class="p">)</span>
<span class="o">&gt;</span> dmultinom<span class="p">(</span>x<span class="p">,</span> size<span class="o">=</span><span class="m">6</span><span class="p">,</span> prob<span class="o">=</span>p<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">0.1312</span>
</pre></div>


<p>Many thanks to Dr. Balka of the University of Guelph for his excellent tutotrial!</p>
<p>*Balka, Jeremey [jbstatistics]. (2012, 12, 18). Introduction to the Multinomial Distribution. [Video file]. Retrieved from https://www.youtube.com/watch?v=syVW7DgvUaY.</p>
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="http://getpelican.com/"><i class="icon-external-link"></i>Pelican</a></li>
    <li><a href="http://python.org/"><i class="icon-external-link"></i>Python.org</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>

    <li><a href="https://github.com/rbrianaaron"><i class="icon-Github-sign icon-large"></i>Github</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="http://rbrianaaron.github.io/blog/category/reflections.html">
    <i class="icon-folder-open icon-large"></i>Reflections
</a>
</li>
<li>
<a href="http://rbrianaaron.github.io/blog/category/tutorials.html">
    <i class="icon-folder-open icon-large"></i>Tutorials
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<li class="tag-1">
    <a href="http://rbrianaaron.github.io/blog/tag/pelican.html">
        <i class="icon-tag icon-large"></i>pelican
    </a>
</li>
<li class="tag-4">
    <a href="http://rbrianaaron.github.io/blog/tag/statistics.html">
        <i class="icon-tag icon-large"></i>statistics
    </a>
</li>
<li class="tag-1">
    <a href="http://rbrianaaron.github.io/blog/tag/r.html">
        <i class="icon-tag icon-large"></i>R
    </a>
</li>
<li class="tag-4">
    <a href="http://rbrianaaron.github.io/blog/tag/markdown.html">
        <i class="icon-tag icon-large"></i>markdown
    </a>
</li>
<li class="tag-2">
    <a href="http://rbrianaaron.github.io/blog/tag/coursera.html">
        <i class="icon-tag icon-large"></i>Coursera
    </a>
</li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://rbrianaaron.github.io/blog/theme/js/jquery-1.7.2.min.js"></script>
    <script src="http://rbrianaaron.github.io/blog/theme/js/bootstrap.min.js"></script>
  </body>
</html>